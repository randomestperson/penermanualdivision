<!DOCTYPE HTML>
<html>
  <head>
    <title>Select Product - Pener Corporation</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>

    <style>
      /* Small page-specific styles */
      .product-select {
        max-width: 820px;
        margin: 0 auto;
        text-align: left;
      }
      .product-header {
        display: flex;
        gap: 1rem;
        align-items: center;
        margin-bottom: 1rem;
      }
      .product-header img {
        width: 220px;
        height: 220px;
        object-fit: cover;
        border-radius: 6px;
      }
      .options {
        margin-top: 1rem;
      }
      .variant-row {
        display: block;
        align-items: center;
        justify-content: space-between;
        padding: 0.6rem;
        border-radius: 6px;
        border: 1px solid rgba(0,0,0,0.06);
        margin-bottom: 0.6rem;
        transition: background 0.2s ease;
      }
      .variant-row:hover {
        background: rgba(0, 0, 0, 0.05);
      }
      .variant-row input[type="radio"] { margin-right: 0.6rem; cursor: pointer; }
      .qty-row {
        margin: 1rem 0;
        display:flex;
        gap: .6rem;
        align-items:center;
      }
      .confirm-message {
        display: none;
        margin-top: 1rem;
        padding: .8rem;
        border-radius: 6px;
        background: #e6ffed;
        color: #0a5b2b;
      }

      /* Link hover effect */
      a {
        color: inherit;
        text-decoration: none;
        transition: color 0.2s ease;
      }
      a:hover {
        color: red !important;
      }

      @media screen and (max-width: 768px) {
        .product-header { flex-direction: column; align-items: center; }
        .product-header img { width: 100%; height: auto; }
      }

    /* Quantity input dark theme */
    #quantity {
        width: 80px;
        padding: .4rem;
        border-radius: 4px;
        border: 1px solid #555;
        background: #000;
        color: #fff;
        text-align: center;
        transition: all 0.2s ease;
    }

    #quantity:focus {
        outline: none;
        border-color: #e33;
        box-shadow: 0 0 4px #e33;
    }
    </style>
  </head>
  <body class="is-preload">
    <div id="page-wrapper">

      <!-- Header (UNCHANGED) -->
      <header id="header">
        <h1 id="logo"><a href="index.html">Pener Corporation Manual Division</a></h1>
        <nav id="nav">
          <ul>
            <li><a href="index.html">Home</a></li>
            <li>
              <a href="products.html">Products</a>
              <ul>
                <li><a href="bpcd.html">BPCD</a></li>
                <li><a href="bomb-defusal-manual.html">Bomb Defusal Manual</a></li>
                <li><a href="the-defusal-times.html">The Defusal Times</a></li>
              </ul>
            </li>
            <li><a href="plan.html">Our Plan</a></li>
            <li><a href="promo.html">Promotional Content</a></li>
            <li><a href="findus.html">Find Us</a></li>
            <li><a href="cart.html" id="cart-button" class="button primary">View Your Cart</a></li>
          </ul>
        </nav>
      </header>

      <!-- Main -->
      <div id="main" class="wrapper style1">
        <div class="container align-center">
          <div class="product-select">

            <header class="major align-center">
              <h2 id="page-title">Select Product</h2>
              <p id="page-sub">Choose your version and add it to cart.</p>
            </header>

            <div class="product-header">
              <img id="product-image" src="images/pic02.jpg" alt="Product image" />
              <div>
                <h3 id="product-name">Product Name</h3>
                <p id="product-desc">Product description goes here.</p>
                <p><strong>Base SKU:</strong> <span id="product-sku">-</span></p>
              </div>
            </div>

            <div class="options" id="options-container">
              <!-- JS inserts variant options here -->
            </div>

            <div class="qty-row">
              <label for="quantity">Quantity:</label>
              <input id="quantity" type="number" value="1" min="1" style="width:80px;padding:.4rem;border-radius:4px;border:1px solid #00000000" />
            </div>

            <div style="display:flex;gap:.6rem;">
              <a id="add-to-cart-btn" class="button primary" href="#">Add to Cart</a>
              <a href="products.html" class="button">Back</a>
              <a id="go-to-cart" class="button" href="cart.html">View Cart</a>
            </div>

            <div id="confirm" class="confirm-message">Added to cart.</div>

          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer id="footer" class="align-center">
        <ul class="icons">
        </ul>
        <ul class="copyright">
          <li>&copy; Pener Corporation. All rights reserved.</li>
        </ul>
      </footer>

    </div>

    <!-- scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/cart.js"></script>

    <script>
      // select.html controller
      (function() {
        const PRODUCTS = {
          "bomb-defusal-manual": {
            name: "Bomb Defusal Manual",
            sku: "BDM-V10",
            img: "images/No Kaboom Paper.jpg",
            desc: "Professional training manual — clear diagrams and step-by-step procedures.",
            variants: [
              { name: "Standard Edition", price: 39.99 },
              { name: "Pro Edition", price: 59.99 },
              { name: "Instructor Edition", price: 89.99 }
            ]
          },
          "bpcd": {
            name: "Bomb-Proof Communication Device",
            sku: "BPCD-100",
            img: "images/bpcd.png",
            desc: "Rugged communication device built for hazardous environments.",
            variants: [
              { name: "BPCD-Lite", price: 299.99 },
              { name: "BPCD-Pro", price: 499.99 },
              { name: "BPCD-Ultimate", price: 799.99 }
            ]
          },
          "defusal-times": {
            name: "The Defusal Times Subscription",
            sku: "DFT-SUB",
            img: "images/The Defusal Times.png",
            desc: "Annual magazine with analyses, interviews, and professional insights.",
            variants: [
              { name: "Digital Edition", price: 19.99 },
              { name: "Print Edition", price: 34.99 },
              { name: "Professional Bundle", price: 49.99 }
            ]
          }
        };

        function getQueryParam(name) {
          const params = new URLSearchParams(window.location.search);
          return params.get(name);
        }

        const productKey = getQueryParam('product') || getQueryParam('p');
        const product = PRODUCTS[productKey];

        if (!product) {
          document.getElementById('page-title').textContent = 'Product not found';
          document.getElementById('page-sub').textContent = 'Please go back to the products page and select a product.';
          document.getElementById('options-container').innerHTML = '';
          document.getElementById('product-image').style.display = 'none';
          document.getElementById('add-to-cart-btn').style.display = 'none';
          return;
        }

        // Populate UI
        document.getElementById('product-name').textContent = product.name;
        document.getElementById('product-desc').textContent = product.desc;
        document.getElementById('product-sku').textContent = product.sku;
        document.getElementById('product-image').src = product.img;

        // Build variant list (no duplicate prices)
        const optionsContainer = document.getElementById('options-container');
        let html = '';
        product.variants.forEach((v, i) => {
          html += `
            <div class="variant-row">
              <label style="width:100%;display:flex;justify-content:space-between;align-items:center;cursor:pointer;">
                <span>
                  <input type="radio" name="variant" value="${i}" ${i===0 ? 'checked' : ''} />
                  <strong>${v.name}</strong>
                </span>
                <span style="font-weight:600;">$${v.price.toFixed(2)}</span>
              </label>
            </div>
          `;
        });
        optionsContainer.innerHTML = html;

        // Add to cart logic
        document.getElementById('add-to-cart-btn').addEventListener('click', function(e) {
          e.preventDefault();
          const qty = Math.max(1, parseInt(document.getElementById('quantity').value, 10) || 1);
          const selectedIndex = document.querySelector('input[name="variant"]:checked').value;
          const variant = product.variants[selectedIndex];
          const fullName = `${product.name} (${variant.name})`;

          for (let i = 0; i < qty; i++) {
            addToCart(fullName, variant.price, variant.name);
          }

          const confirmEl = document.getElementById('confirm');
          confirmEl.textContent = `${qty} × ${fullName} added to cart.`;
          confirmEl.style.display = 'block';
          updateCartCount();
        });
      })();
    </script>
  </body>
</html>